package p0d

import (
	"encoding/json"
	"fmt"
	"github.com/google/uuid"
	"github.com/gosuri/uilive"
	"github.com/hako/durafmt"
	. "github.com/logrusorgru/aurora"
	"io"
	"math"
	"math/rand"
	"net/http"
	"net/http/httputil"
	"os"
	"os/signal"
	"strconv"
	"strings"
	"syscall"
	"time"
)

const Version string = "v0.2.4"

type P0d struct {
	ID             string
	Config         Config
	client         *http.Client
	Stats          *Stats
	Start          time.Time
	Stop           time.Time
	Output         string
	outFile        *os.File
	liveWriters    []io.Writer
	bar            *ProgressBar
	Interrupted    bool
	interrupt      chan os.Signal
	OsMaxOpenFiles int64
}

type ReqAtmpt struct {
	Start    time.Time
	Stop     time.Time
	ElpsdNs  time.Duration
	ReqBytes int64
	ResCode  int
	ResBytes int64
	ResErr   string
}

func NewP0dWithValues(t int, c int, d int, u string, h string, o string) *P0d {
	hv, _ := strconv.ParseFloat(h, 32)

	cfg := Config{
		Req: Req{
			Method: "GET",
			Url:    u,
		},
		Exec: Exec{
			Threads:         t,
			DurationSeconds: d,
			Connections:     c,
			HttpVersion:     float32(hv),
		},
	}
	cfg = *cfg.validate()

	start := time.Now()
	_, ul := getUlimit()

	sigs := make(chan os.Signal, 1)
	signal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM, syscall.SIGKILL, syscall.SIGQUIT)

	return &P0d{
		ID:     createRunId(),
		Config: cfg,
		client: cfg.scaffoldHttpClient(),
		Stats: &Stats{
			Start:      start,
			ErrorTypes: make(map[string]int),
		},
		Start:          start,
		Output:         o,
		OsMaxOpenFiles: ul,
		interrupt:      sigs,
		Interrupted:    false,
		bar: &ProgressBar{
			maxSecs: d,
			size:    20,
		},
	}
}

func NewP0dFromFile(f string, o string) *P0d {
	cfg := loadConfigFromFile(f)
	cfg.File = f
	cfg = cfg.validate()

	start := time.Now()
	_, ul := getUlimit()

	sigs := make(chan os.Signal, 1)
	signal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM, syscall.SIGKILL, syscall.SIGQUIT)

	return &P0d{
		ID:     createRunId(),
		Config: *cfg,
		client: cfg.scaffoldHttpClient(),
		Stats: &Stats{
			Start:      start,
			ErrorTypes: make(map[string]int),
		},
		Start:          time.Now(),
		Output:         o,
		OsMaxOpenFiles: ul,
		interrupt:      sigs,
		Interrupted:    false,
		bar: &ProgressBar{
			maxSecs: cfg.Exec.DurationSeconds,
			size:    20,
		},
	}
}

func (p *P0d) Race() {
	_, p.OsMaxOpenFiles = getUlimit()
	p.logBootstrap()

	end := make(chan struct{})
	ras := make(chan ReqAtmpt, 65535)

	//init timer for race to end
	time.AfterFunc(time.Duration(p.Config.Exec.DurationSeconds)*time.Second, func() {
		end <- struct{}{}
	})

	defer func() {
		if p.outFile != nil {
			p.outFile.Close()
		}
	}()
	p.initOutFile()

	for i := 0; i < p.Config.Exec.Threads; i++ {
		go p.doReqAtmpt(ras)
	}

	p.initLiveWriters(9)

	const prefix string = ""
	const indent string = "  "
	var comma = []byte(",\n")
	const backspace = "\x1b[%dD"
Main:
	for {
		select {
		case <-p.interrupt:
			//because CTRL+C is crazy and messes up our live log by two spaces
			fmt.Fprintf(p.liveWriters[0], backspace, 2)
			p.Stop = time.Now()
			p.finaliseOutputAndCloseWriters()
			p.Interrupted = true
			break Main
		case <-end:
			p.Stop = time.Now()
			p.finaliseOutputAndCloseWriters()
			break Main
		case ra := <-ras:
			p.Stats.update(ra, time.Now(), p.Config)
			p.logRequestAttempt(ra, prefix, indent, comma)
		}
	}

	log("done")
}

func (p *P0d) doReqAtmpt(ras chan<- ReqAtmpt) {
	for {
		//introduce artifical request latency
		if p.Config.Exec.SpacingMillis > 0 {
			time.Sleep(time.Duration(p.Config.Exec.SpacingMillis) * time.Millisecond)
		}

		ra := ReqAtmpt{
			Start: time.Now(),
		}

		req, _ := http.NewRequest(p.Config.Req.Method,
			p.Config.Req.Url,
			strings.NewReader(p.Config.Req.Body))

		if len(p.Config.Req.Headers) > 0 {
			for _, h := range p.Config.Req.Headers {
				for k, v := range h {
					req.Header.Add(k, v)
				}
			}
		}

		bq, _ := httputil.DumpRequest(req, true)
		ra.ReqBytes = int64(len(bq))
		_ = bq

		res, e := p.client.Do(req)
		if res != nil {
			ra.ResCode = res.StatusCode
			b, _ := httputil.DumpResponse(res, true)
			ra.ResBytes = int64(len(b))
			_ = b
			res.Body.Close()
		}

		ra.Stop = time.Now()
		ra.ElpsdNs = ra.Stop.Sub(ra.Start)

		if e != nil {
			em := ""
			for ek, ev := range connectionErrors {
				if strings.Contains(e.Error(), ek) {
					em = ev
				}
			}
			if em == "" {
				em = e.Error()
			}
			ra.ResErr = em
		}

		req = nil

		ras <- ra
	}
}

func (p *P0d) finaliseOutputAndCloseWriters() {
	//call final log manually to prevent differences between summary and what's on screen in live log.
	p.logLive()
	p.liveWriters[0].(*uilive.Writer).Stop()
	p.logSummary()

	if len(p.Output) > 0 {
		log("finalizing log file '%s'", Yellow(p.Output))
		j, je := json.MarshalIndent(p, "", "  ")
		p.checkWrite(je)
		_, we := p.outFile.Write(j)
		p.checkWrite(we)
		_, we = p.outFile.Write([]byte("]"))
		p.checkWrite(we)
	}
}

func (p *P0d) logBootstrap() {
	fmt.Printf("%v", "\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;236;242;249m@\u001B[0m\u001B[38;2;141;175;217m*\u001B[0m\u001B[38;2;67;124;202m=\u001B[0m\u001B[38;2;43;108;193m-\u001B[0m\u001B[38;2;53;114;188m=\u001B[0m\u001B[38;2;50;112;189m=\u001B[0m\u001B[38;2;39;104;185m-\u001B[0m\u001B[38;2;31;97;181m-\u001B[0m\u001B[38;2;35;99;181m-\u001B[0m\u001B[38;2;52;113;189m=\u001B[0m\u001B[38;2;78;135;203m=\u001B[0m\u001B[38;2;101;155;215m+\u001B[0m\u001B[38;2;123;173;226m*\u001B[0m\u001B[38;2;131;178;228m*\u001B[0m\u001B[38;2;128;166;214m*\u001B[0m\u001B[38;2;127;170;220m*\u001B[0m\u001B[38;2;116;164;218m*\u001B[0m\u001B[38;2;92;146;208m+\u001B[0m\u001B[38;2;70;128;198m=\u001B[0m\u001B[38;2;46;108;186m-\u001B[0m\u001B[38;2;32;97;179m-\u001B[0m\u001B[38;2;31;97;181m-\u001B[0m\u001B[38;2;43;106;186m-\u001B[0m\u001B[38;2;52;113;189m=\u001B[0m\u001B[38;2;52;113;189m=\u001B[0m\u001B[38;2;61;119;193m=\u001B[0m\u001B[38;2;102;150;217m+\u001B[0m\u001B[38;2;187;208;233m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;251m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;251m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;254;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;195;213;235m%\u001B[0m\u001B[38;2;46;109;186m-\u001B[0m\u001B[38;2;56;117;197m=\u001B[0m\u001B[38;2;184;201;194m#\u001B[0m\u001B[38;2;122;158;182m+\u001B[0m\u001B[38;2;18;90;187m-\u001B[0m\u001B[38;2;37;100;180m-\u001B[0m\u001B[38;2;81;134;199m=\u001B[0m\u001B[38;2;142;182;226m*\u001B[0m\u001B[38;2;196;224;250m%\u001B[0m\u001B[38;2;227;237;248m@\u001B[0m\u001B[38;2;240;230;231m@\u001B[0m\u001B[38;2;243;216;211m%\u001B[0m\u001B[38;2;241;198;189m%\u001B[0m\u001B[38;2;240;195;185m%\u001B[0m\u001B[38;2;255;255;252m@\u001B[0m\u001B[38;2;255;237;231m@\u001B[0m\u001B[38;2;249;225;220m@\u001B[0m\u001B[38;2;246;231;228m@\u001B[0m\u001B[38;2;238;236;239m@\u001B[0m\u001B[38;2;220;236;251m@\u001B[0m\u001B[38;2;184;218;249m%\u001B[0m\u001B[38;2;125;173;224m*\u001B[0m\u001B[38;2;63;121;194m=\u001B[0m\u001B[38;2;31;98;181m-\u001B[0m\u001B[38;2;21;92;180m-\u001B[0m\u001B[38;2;131;169;214m*\u001B[0m\u001B[38;2;177;194;176m#\u001B[0m\u001B[38;2;56;116;190m=\u001B[0m\u001B[38;2;107;151;209m+\u001B[0m\u001B[38;2;247;250;252m@\u001B[0m\u001B[38;2;254;254;254m@\u001B[0m\u001B[38;2;254;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;57;117;191m=\u001B[0m\u001B[38;2;28;96;181m-\u001B[0m\u001B[38;2;68;125;198m=\u001B[0m\u001B[38;2;116;156;190m+\u001B[0m\u001B[38;2;82;131;182m=\u001B[0m\u001B[38;2;115;159;215m+\u001B[0m\u001B[38;2;215;236;253m@\u001B[0m\u001B[38;2;255;254;252m@\u001B[0m\u001B[38;2;255;227;217m@\u001B[0m\u001B[38;2;230;160;144m#\u001B[0m\u001B[38;2;205;101;81m+\u001B[0m\u001B[38;2;191;71;51m=\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;180;49;27m-\u001B[0m\u001B[38;2;232;194;189m%\u001B[0m\u001B[38;2;229;186;179m#\u001B[0m\u001B[38;2;180;49;29m-\u001B[0m\u001B[38;2;185;61;41m-\u001B[0m\u001B[38;2;189;68;48m=\u001B[0m\u001B[38;2;196;82;62m=\u001B[0m\u001B[38;2;206;98;78m+\u001B[0m\u001B[38;2;225;141;123m*\u001B[0m\u001B[38;2;249;207;196m%\u001B[0m\u001B[38;2;247;248;250m@\u001B[0m\u001B[38;2;187;210;236m%\u001B[0m\u001B[38;2;81;131;196m=\u001B[0m\u001B[38;2;77;130;197m=\u001B[0m\u001B[38;2;125;161;186m*\u001B[0m\u001B[38;2;64;121;193m=\u001B[0m\u001B[38;2;16;88;178m-\u001B[0m\u001B[38;2;185;206;232m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;253;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;241;217;213m%\u001B[0m\u001B[38;2;227;179;172m#\u001B[0m\u001B[38;2;218;156;146m*\u001B[0m\u001B[38;2;215;148;137m*\u001B[0m\u001B[38;2;216;149;139m*\u001B[0m\u001B[38;2;220;160;151m*\u001B[0m\u001B[38;2;230;187;181m#\u001B[0m\u001B[38;2;245;230;227m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;246;233;231m@\u001B[0m\u001B[38;2;229;186;180m#\u001B[0m\u001B[38;2;231;190;184m#\u001B[0m\u001B[38;2;231;190;184m#\u001B[0m\u001B[38;2;229;185;178m#\u001B[0m\u001B[38;2;239;213;209m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;54;114;190m=\u001B[0m\u001B[38;2;48;110;188m-\u001B[0m\u001B[38;2;26;95;180m-\u001B[0m\u001B[38;2;65;122;197m=\u001B[0m\u001B[38;2;203;222;246m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;235;182;173m#\u001B[0m\u001B[38;2;253;250;249m@\u001B[0m\u001B[38;2;197;100;85m=\u001B[0m\u001B[38;2;170;22;0m:\u001B[0m\u001B[38;2;184;60;40m-\u001B[0m\u001B[38;2;188;70;50m=\u001B[0m\u001B[38;2;181;50;28m-\u001B[0m\u001B[38;2;208;124;110m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;196;90;73m=\u001B[0m\u001B[38;2;182;53;31m-\u001B[0m\u001B[38;2;190;72;53m=\u001B[0m\u001B[38;2;182;53;31m-\u001B[0m\u001B[38;2;180;48;27m-\u001B[0m\u001B[38;2;196;95;79m=\u001B[0m\u001B[38;2;213;143;133m*\u001B[0m\u001B[38;2;220;164;158m#\u001B[0m\u001B[38;2;237;199;193m%\u001B[0m\u001B[38;2;255;248;242m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;164;191;225m#\u001B[0m\u001B[38;2;31;99;189m-\u001B[0m\u001B[38;2;37;102;184m-\u001B[0m\u001B[38;2;37;103;184m-\u001B[0m\u001B[38;2;173;198;228m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;253;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;253;252m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;238;209;205m%\u001B[0m\u001B[38;2;201;105;90m+\u001B[0m\u001B[38;2;185;61;41m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;182;51;30m-\u001B[0m\u001B[38;2;180;44;21m-\u001B[0m\u001B[38;2;180;46;24m-\u001B[0m\u001B[38;2;182;53;31m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;188;68;49m=\u001B[0m\u001B[38;2;209;130;118m+\u001B[0m\u001B[38;2;247;234;233m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;230;188;183m#\u001B[0m\u001B[38;2;179;44;22m-\u001B[0m\u001B[38;2;184;56;36m-\u001B[0m\u001B[38;2;184;58;37m-\u001B[0m\u001B[38;2;179;41;19m-\u001B[0m\u001B[38;2;207;126;114m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;60;119;192m=\u001B[0m\u001B[38;2;26;94;181m-\u001B[0m\u001B[38;2;103;148;205m+\u001B[0m\u001B[38;2;255;255;254m@\u001B[0m\u001B[38;2;255;239;232m@\u001B[0m\u001B[38;2;195;95;80m=\u001B[0m\u001B[38;2;174;34;13m:\u001B[0m\u001B[38;2;227;177;169m#\u001B[0m\u001B[38;2;253;249;248m@\u001B[0m\u001B[38;2;210;129;116m+\u001B[0m\u001B[38;2;182;52;31m-\u001B[0m\u001B[38;2;183;54;33m-\u001B[0m\u001B[38;2;181;48;26m-\u001B[0m\u001B[38;2;207;120;106m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;195;87;69m=\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;181;48;26m-\u001B[0m\u001B[38;2;203;109;93m+\u001B[0m\u001B[38;2;241;215;211m%\u001B[0m\u001B[38;2;242;220;216m%\u001B[0m\u001B[38;2;221;160;150m*\u001B[0m\u001B[38;2;203;109;93m+\u001B[0m\u001B[38;2;188;71;52m=\u001B[0m\u001B[38;2;186;70;52m=\u001B[0m\u001B[38;2;222;165;157m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;222;231;242m@\u001B[0m\u001B[38;2;58;117;191m=\u001B[0m\u001B[38;2;24;94;180m-\u001B[0m\u001B[38;2;179;202;230m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;253;254m@\u001B[0m\u001B[38;2;254;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;250;242;241m@\u001B[0m\u001B[38;2;247;233;230m@\u001B[0m\u001B[38;2;247;234;232m@\u001B[0m\u001B[38;2;251;244;243m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;238;212;209m%\u001B[0m\u001B[38;2;186;64;45m-\u001B[0m\u001B[38;2;184;54;33m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;188;69;50m=\u001B[0m\u001B[38;2;201;107;93m+\u001B[0m\u001B[38;2;198;96;80m=\u001B[0m\u001B[38;2;187;64;44m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;181;48;27m-\u001B[0m\u001B[38;2;197;94;78m=\u001B[0m\u001B[38;2;249;240;239m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;249;249m@\u001B[0m\u001B[38;2;248;237;236m@\u001B[0m\u001B[38;2;246;230;227m@\u001B[0m\u001B[38;2;251;244;243m@\u001B[0m\u001B[38;2;232;193;189m%\u001B[0m\u001B[38;2;184;57;37m-\u001B[0m\u001B[38;2;189;69;49m=\u001B[0m\u001B[38;2;189;70;50m=\u001B[0m\u001B[38;2;184;54;34m-\u001B[0m\u001B[38;2;211;135;123m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;46;109;188m-\u001B[0m\u001B[38;2;60;118;191m=\u001B[0m\u001B[38;2;248;249;251m@\u001B[0m\u001B[38;2;252;247;246m@\u001B[0m\u001B[38;2;196;96;81m=\u001B[0m\u001B[38;2;181;49;28m-\u001B[0m\u001B[38;2;190;74;55m=\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;209;125;111m+\u001B[0m\u001B[38;2;242;219;215m%\u001B[0m\u001B[38;2;238;207;202m%\u001B[0m\u001B[38;2;212;135;122m*\u001B[0m\u001B[38;2;189;72;53m=\u001B[0m\u001B[38;2;182;50;29m-\u001B[0m\u001B[38;2;249;239;237m@\u001B[0m\u001B[38;2;211;131;118m*\u001B[0m\u001B[38;2;177;36;14m:\u001B[0m\u001B[38;2;225;172;163m#\u001B[0m\u001B[38;2;243;222;218m%\u001B[0m\u001B[38;2;207;121;107m+\u001B[0m\u001B[38;2;179;42;20m-\u001B[0m\u001B[38;2;175;32;9m:\u001B[0m\u001B[38;2;178;40;17m-\u001B[0m\u001B[38;2;181;48;27m-\u001B[0m\u001B[38;2;181;49;28m-\u001B[0m\u001B[38;2;175;31;7m:\u001B[0m\u001B[38;2;212;145;136m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;203;218;237m%\u001B[0m\u001B[38;2;18;89;178m-\u001B[0m\u001B[38;2;177;200;230m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;252;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;231;190;183m#\u001B[0m\u001B[38;2;210;132;120m*\u001B[0m\u001B[38;2;198;97;81m=\u001B[0m\u001B[38;2;193;82;65m=\u001B[0m\u001B[38;2;189;72;52m=\u001B[0m\u001B[38;2;190;74;55m=\u001B[0m\u001B[38;2;193;84;67m=\u001B[0m\u001B[38;2;199;99;83m=\u001B[0m\u001B[38;2;212;138;127m*\u001B[0m\u001B[38;2;235;201;196m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;208;125;112m+\u001B[0m\u001B[38;2;183;52;31m-\u001B[0m\u001B[38;2;189;70;51m=\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;183;53;31m-\u001B[0m\u001B[38;2;209;127;114m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;251;245;245m@\u001B[0m\u001B[38;2;195;93;77m=\u001B[0m\u001B[38;2;186;60;39m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;189;70;51m=\u001B[0m\u001B[38;2;182;50;28m-\u001B[0m\u001B[38;2;226;178;172m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;252;251m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;247;235;234m@\u001B[0m\u001B[38;2;223;168;160m#\u001B[0m\u001B[38;2;204;115;100m+\u001B[0m\u001B[38;2;195;89;72m=\u001B[0m\u001B[38;2;192;79;61m=\u001B[0m\u001B[38;2;186;62;42m-\u001B[0m\u001B[38;2;208;124;111m+\u001B[0m\u001B[38;2;234;199;194m%\u001B[0m\u001B[38;2;183;54;33m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;183;52;31m-\u001B[0m\u001B[38;2;210;133;121m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;33;100;183m-\u001B[0m\u001B[38;2;156;185;222m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;244;232;231m@\u001B[0m\u001B[38;2;185;60;39m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;181;49;27m-\u001B[0m\u001B[38;2;182;52;30m-\u001B[0m\u001B[38;2;177;36;13m:\u001B[0m\u001B[38;2;178;39;16m-\u001B[0m\u001B[38;2;197;92;75m=\u001B[0m\u001B[38;2;218;151;140m*\u001B[0m\u001B[38;2;226;174;166m#\u001B[0m\u001B[38;2;207;123;110m+\u001B[0m\u001B[38;2;218;153;144m*\u001B[0m\u001B[38;2;222;163;154m#\u001B[0m\u001B[38;2;217;148;138m*\u001B[0m\u001B[38;2;228;180;173m#\u001B[0m\u001B[38;2;196;89;72m=\u001B[0m\u001B[38;2;198;95;78m=\u001B[0m\u001B[38;2;210;128;115m+\u001B[0m\u001B[38;2;214;139;127m*\u001B[0m\u001B[38;2;216;147;136m*\u001B[0m\u001B[38;2;215;143;132m*\u001B[0m\u001B[38;2;211;131;118m*\u001B[0m\u001B[38;2;201;103;87m+\u001B[0m\u001B[38;2;182;52;31m-\u001B[0m\u001B[38;2;239;217;214m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;80;131;197m=\u001B[0m\u001B[38;2;161;189;225m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;255;255m@\u001B[0m\u001B[38;2;243;223;221m%\u001B[0m\u001B[38;2;198;99;83m=\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;182;52;31m-\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;184;55;34m-\u001B[0m\u001B[38;2;203;112;98m+\u001B[0m\u001B[38;2;246;233;231m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;204;114;100m+\u001B[0m\u001B[38;2;184;56;35m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;214;140;128m*\u001B[0m\u001B[38;2;255;255;254m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;200;107;94m+\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;221;167;159m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;227;180;173m#\u001B[0m\u001B[38;2;189;74;55m=\u001B[0m\u001B[38;2;182;51;30m-\u001B[0m\u001B[38;2;184;56;35m-\u001B[0m\u001B[38;2;184;57;36m-\u001B[0m\u001B[38;2;183;52;30m-\u001B[0m\u001B[38;2;178;39;17m-\u001B[0m\u001B[38;2;200;100;83m+\u001B[0m\u001B[38;2;234;199;194m%\u001B[0m\u001B[38;2;183;54;33m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;183;52;31m-\u001B[0m\u001B[38;2;210;133;121m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;37;102;185m-\u001B[0m\u001B[38;2;188;207;232m%\u001B[0m\u001B[38;2;254;254;254m@\u001B[0m\u001B[38;2;229;188;181m#\u001B[0m\u001B[38;2;224;168;159m#\u001B[0m\u001B[38;2;226;173;164m#\u001B[0m\u001B[38;2;222;164;154m#\u001B[0m\u001B[38;2;218;152;141m*\u001B[0m\u001B[38;2;218;150;139m*\u001B[0m\u001B[38;2;218;152;141m*\u001B[0m\u001B[38;2;216;146;135m*\u001B[0m\u001B[38;2;215;143;131m*\u001B[0m\u001B[38;2;212;134;123m*\u001B[0m\u001B[38;2;215;146;135m*\u001B[0m\u001B[38;2;243;220;216m%\u001B[0m\u001B[38;2;248;236;234m@\u001B[0m\u001B[38;2;235;198;192m%\u001B[0m\u001B[38;2;211;134;125m*\u001B[0m\u001B[38;2;216;146;135m*\u001B[0m\u001B[38;2;220;157;147m*\u001B[0m\u001B[38;2;224;168;159m#\u001B[0m\u001B[38;2;225;171;163m#\u001B[0m\u001B[38;2;225;171;162m#\u001B[0m\u001B[38;2;227;176;169m#\u001B[0m\u001B[38;2;232;190;183m#\u001B[0m\u001B[38;2;238;209;204m%\u001B[0m\u001B[38;2;235;199;193m%\u001B[0m\u001B[38;2;242;225;223m@\u001B[0m\u001B[38;2;253;254;254m@\u001B[0m\u001B[38;2;111;153;207m+\u001B[0m\u001B[38;2;155;185;222m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;250;246;246m@\u001B[0m\u001B[38;2;197;96;80m=\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;189;69;50m=\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;210;131;120m*\u001B[0m\u001B[38;2;228;184;177m#\u001B[0m\u001B[38;2;225;174;167m#\u001B[0m\u001B[38;2;205;117;103m+\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;188;68;49m=\u001B[0m\u001B[38;2;188;68;49m=\u001B[0m\u001B[38;2;182;49;27m-\u001B[0m\u001B[38;2;201;107;93m+\u001B[0m\u001B[38;2;253;250;250m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;204;115;102m+\u001B[0m\u001B[38;2;184;55;34m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;213;137;125m*\u001B[0m\u001B[38;2;254;252;251m@\u001B[0m\u001B[38;2;252;248;248m@\u001B[0m\u001B[38;2;199;105;91m+\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;221;167;159m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;233;197;191m%\u001B[0m\u001B[38;2;183;54;33m-\u001B[0m\u001B[38;2;186;62;41m-\u001B[0m\u001B[38;2;188;69;50m=\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;191;78;60m=\u001B[0m\u001B[38;2;215;145;134m*\u001B[0m\u001B[38;2;222;164;156m#\u001B[0m\u001B[38;2;226;174;167m#\u001B[0m\u001B[38;2;233;198;194m%\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;210;133;121m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;33;100;183m-\u001B[0m\u001B[38;2;156;184;220m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;217;157;148m*\u001B[0m\u001B[38;2;179;44;21m-\u001B[0m\u001B[38;2;202;107;91m+\u001B[0m\u001B[38;2;208;123;109m+\u001B[0m\u001B[38;2;210;130;116m+\u001B[0m\u001B[38;2;210;131;117m*\u001B[0m\u001B[38;2;210;128;115m+\u001B[0m\u001B[38;2;202;108;93m+\u001B[0m\u001B[38;2;192;79;60m=\u001B[0m\u001B[38;2;207;120;107m+\u001B[0m\u001B[38;2;234;196;191m%\u001B[0m\u001B[38;2;207;121;109m+\u001B[0m\u001B[38;2;232;190;183m#\u001B[0m\u001B[38;2;205;114;103m+\u001B[0m\u001B[38;2;219;154;144m*\u001B[0m\u001B[38;2;224;169;160m#\u001B[0m\u001B[38;2;208;122;108m+\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;175;30;7m:\u001B[0m\u001B[38;2;180;44;22m-\u001B[0m\u001B[38;2;181;50;28m-\u001B[0m\u001B[38;2;182;52;30m-\u001B[0m\u001B[38;2;181;47;25m-\u001B[0m\u001B[38;2;206;117;102m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;81;133;199m=\u001B[0m\u001B[38;2;161;188;223m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;220;218m%\u001B[0m\u001B[38;2;187;67;48m-\u001B[0m\u001B[38;2;188;66;46m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;185;58;38m-\u001B[0m\u001B[38;2;196;92;75m=\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;241;219;217m%\u001B[0m\u001B[38;2;187;68;49m-\u001B[0m\u001B[38;2;187;64;44m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;188;66;47m-\u001B[0m\u001B[38;2;187;67;48m-\u001B[0m\u001B[38;2;247;236;234m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;204;114;99m+\u001B[0m\u001B[38;2;184;56;35m-\u001B[0m\u001B[38;2;188;68;49m=\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;182;50;29m-\u001B[0m\u001B[38;2;214;140;129m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;199;104;90m+\u001B[0m\u001B[38;2;185;58;37m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;189;69;50m=\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;221;165;157m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;216;150;140m*\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;189;72;53m=\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;55;33m-\u001B[0m\u001B[38;2;209;131;119m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;223;171;163m#\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;189;70;51m=\u001B[0m\u001B[38;2;182;51;29m-\u001B[0m\u001B[38;2;210;133;121m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;46;109;187m-\u001B[0m\u001B[38;2;61;119;191m=\u001B[0m\u001B[38;2;249;250;252m@\u001B[0m\u001B[38;2;252;247;246m@\u001B[0m\u001B[38;2;195;95;79m=\u001B[0m\u001B[38;2;176;35;12m:\u001B[0m\u001B[38;2;182;51;30m-\u001B[0m\u001B[38;2;179;44;22m-\u001B[0m\u001B[38;2;177;36;13m:\u001B[0m\u001B[38;2;176;35;11m:\u001B[0m\u001B[38;2;191;74;56m=\u001B[0m\u001B[38;2;227;177;169m#\u001B[0m\u001B[38;2;243;220;217m%\u001B[0m\u001B[38;2;204;112;97m+\u001B[0m\u001B[38;2;175;31;8m:\u001B[0m\u001B[38;2;243;222;219m%\u001B[0m\u001B[38;2;221;161;151m*\u001B[0m\u001B[38;2;177;36;13m:\u001B[0m\u001B[38;2;200;103;86m+\u001B[0m\u001B[38;2;225;172;163m#\u001B[0m\u001B[38;2;245;227;224m@\u001B[0m\u001B[38;2;227;177;168m#\u001B[0m\u001B[38;2;191;75;56m=\u001B[0m\u001B[38;2;186;61;40m-\u001B[0m\u001B[38;2;190;75;56m=\u001B[0m\u001B[38;2;178;40;17m-\u001B[0m\u001B[38;2;214;152;143m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;204;218;236m%\u001B[0m\u001B[38;2;18;89;178m-\u001B[0m\u001B[38;2;176;199;228m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;220;218m%\u001B[0m\u001B[38;2;188;71;52m=\u001B[0m\u001B[38;2;187;64;43m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;55;35m-\u001B[0m\u001B[38;2;202;106;90m+\u001B[0m\u001B[38;2;238;212;208m%\u001B[0m\u001B[38;2;204;114;100m+\u001B[0m\u001B[38;2;206;121;107m+\u001B[0m\u001B[38;2;191;78;60m=\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;188;68;49m=\u001B[0m\u001B[38;2;186;63;43m-\u001B[0m\u001B[38;2;180;46;24m-\u001B[0m\u001B[38;2;213;140;129m*\u001B[0m\u001B[38;2;254;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;225;174;167m#\u001B[0m\u001B[38;2;180;48;26m-\u001B[0m\u001B[38;2;187;66;46m-\u001B[0m\u001B[38;2;189;69;50m=\u001B[0m\u001B[38;2;186;63;43m-\u001B[0m\u001B[38;2;194;86;68m=\u001B[0m\u001B[38;2;223;167;158m#\u001B[0m\u001B[38;2;217;150;140m*\u001B[0m\u001B[38;2;188;70;51m=\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;69;50m=\u001B[0m\u001B[38;2;185;59;39m-\u001B[0m\u001B[38;2;186;63;43m-\u001B[0m\u001B[38;2;240;216;213m%\u001B[0m\u001B[38;2;255;255;254m@\u001B[0m\u001B[38;2;239;213;209m%\u001B[0m\u001B[38;2;187;68;48m-\u001B[0m\u001B[38;2;183;54;33m-\u001B[0m\u001B[38;2;188;67;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;202;109;94m+\u001B[0m\u001B[38;2;212;135;122m*\u001B[0m\u001B[38;2;207;122;109m+\u001B[0m\u001B[38;2;189;73;54m=\u001B[0m\u001B[38;2;188;66;47m-\u001B[0m\u001B[38;2;188;68;48m-\u001B[0m\u001B[38;2;184;58;37m-\u001B[0m\u001B[38;2;184;57;37m-\u001B[0m\u001B[38;2;235;203;198m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;60;119;192m=\u001B[0m\u001B[38;2;25;94;181m-\u001B[0m\u001B[38;2;105;150;206m+\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;250;244m@\u001B[0m\u001B[38;2;207;130;119m+\u001B[0m\u001B[38;2;187;70;51m=\u001B[0m\u001B[38;2;198;97;81m=\u001B[0m\u001B[38;2;215;143;131m*\u001B[0m\u001B[38;2;234;196;190m%\u001B[0m\u001B[38;2;245;228;225m@\u001B[0m\u001B[38;2;224;167;158m#\u001B[0m\u001B[38;2;187;65;45m-\u001B[0m\u001B[38;2;183;55;35m-\u001B[0m\u001B[38;2;182;52;30m-\u001B[0m\u001B[38;2;227;177;169m#\u001B[0m\u001B[38;2;248;236;234m@\u001B[0m\u001B[38;2;184;58;37m-\u001B[0m\u001B[38;2;184;57;36m-\u001B[0m\u001B[38;2;181;47;25m-\u001B[0m\u001B[38;2;192;78;60m=\u001B[0m\u001B[38;2;237;206;201m%\u001B[0m\u001B[38;2;249;239;238m@\u001B[0m\u001B[38;2;194;84;67m=\u001B[0m\u001B[38;2;175;37;16m:\u001B[0m\u001B[38;2;212;140;129m*\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;222;231;241m@\u001B[0m\u001B[38;2;59;118;191m=\u001B[0m\u001B[38;2;24;93;180m-\u001B[0m\u001B[38;2;178;200;229m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;220;218m%\u001B[0m\u001B[38;2;188;70;51m=\u001B[0m\u001B[38;2;187;64;43m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;55;34m-\u001B[0m\u001B[38;2;202;108;92m+\u001B[0m\u001B[38;2;233;197;192m%\u001B[0m\u001B[38;2;177;36;13m:\u001B[0m\u001B[38;2;181;48;26m-\u001B[0m\u001B[38;2;183;52;31m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;182;53;32m-\u001B[0m\u001B[38;2;190;76;58m=\u001B[0m\u001B[38;2;220;161;151m*\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;216;151;141m*\u001B[0m\u001B[38;2;185;62;43m-\u001B[0m\u001B[38;2;182;51;30m-\u001B[0m\u001B[38;2;184;56;35m-\u001B[0m\u001B[38;2;184;55;33m-\u001B[0m\u001B[38;2;181;47;25m-\u001B[0m\u001B[38;2;181;48;26m-\u001B[0m\u001B[38;2;184;56;35m-\u001B[0m\u001B[38;2;183;55;33m-\u001B[0m\u001B[38;2;182;52;31m-\u001B[0m\u001B[38;2;190;75;57m=\u001B[0m\u001B[38;2;230;188;182m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;252m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;213;209m%\u001B[0m\u001B[38;2;200;105;90m+\u001B[0m\u001B[38;2;185;60;39m-\u001B[0m\u001B[38;2;182;52;30m-\u001B[0m\u001B[38;2;183;53;32m-\u001B[0m\u001B[38;2;181;47;25m-\u001B[0m\u001B[38;2;179;43;21m-\u001B[0m\u001B[38;2;180;45;23m-\u001B[0m\u001B[38;2;183;53;31m-\u001B[0m\u001B[38;2;182;52;31m-\u001B[0m\u001B[38;2;184;56;36m-\u001B[0m\u001B[38;2;195;91;75m=\u001B[0m\u001B[38;2;233;196;191m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;253m@\u001B[0m\n\u001B[38;2;54;114;190m=\u001B[0m\u001B[38;2;48;110;188m-\u001B[0m\u001B[38;2;24;94;179m-\u001B[0m\u001B[38;2;70;125;200m=\u001B[0m\u001B[38;2;204;222;246m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;241;236m@\u001B[0m\u001B[38;2;230;185;179m#\u001B[0m\u001B[38;2;213;147;137m*\u001B[0m\u001B[38;2;201;109;96m+\u001B[0m\u001B[38;2;185;62;42m-\u001B[0m\u001B[38;2;179;44;22m-\u001B[0m\u001B[38;2;186;62;42m-\u001B[0m\u001B[38;2;189;71;52m=\u001B[0m\u001B[38;2;178;40;17m-\u001B[0m\u001B[38;2;236;203;198m%\u001B[0m\u001B[38;2;250;240;239m@\u001B[0m\u001B[38;2;184;56;36m-\u001B[0m\u001B[38;2;187;66;46m-\u001B[0m\u001B[38;2;187;66;47m-\u001B[0m\u001B[38;2;179;47;26m-\u001B[0m\u001B[38;2;171;27;4m:\u001B[0m\u001B[38;2;236;208;205m%\u001B[0m\u001B[38;2;237;202;196m%\u001B[0m\u001B[38;2;241;193;183m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;165;192;226m#\u001B[0m\u001B[38;2;36;102;193m-\u001B[0m\u001B[38;2;35;101;184m-\u001B[0m\u001B[38;2;38;103;184m-\u001B[0m\u001B[38;2;173;196;227m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;220;218m%\u001B[0m\u001B[38;2;188;70;51m=\u001B[0m\u001B[38;2;187;64;43m-\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;183;56;35m-\u001B[0m\u001B[38;2;201;105;89m+\u001B[0m\u001B[38;2;239;214;210m%\u001B[0m\u001B[38;2;199;101;85m+\u001B[0m\u001B[38;2;202;110;95m+\u001B[0m\u001B[38;2;204;113;99m+\u001B[0m\u001B[38;2;213;140;129m*\u001B[0m\u001B[38;2;229;184;178m#\u001B[0m\u001B[38;2;248;238;237m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;242;220;217m%\u001B[0m\u001B[38;2;217;152;142m*\u001B[0m\u001B[38;2;204;114;100m+\u001B[0m\u001B[38;2;197;95;79m=\u001B[0m\u001B[38;2;195;86;69m=\u001B[0m\u001B[38;2;195;88;70m=\u001B[0m\u001B[38;2;199;100;84m+\u001B[0m\u001B[38;2;206;121;107m+\u001B[0m\u001B[38;2;223;169;160m#\u001B[0m\u001B[38;2;248;238;237m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;238;210;207m%\u001B[0m\u001B[38;2;220;160;151m*\u001B[0m\u001B[38;2;209;126;113m+\u001B[0m\u001B[38;2;202;110;95m+\u001B[0m\u001B[38;2;202;109;94m+\u001B[0m\u001B[38;2;202;109;94m+\u001B[0m\u001B[38;2;207;123;110m+\u001B[0m\u001B[38;2;219;156;146m*\u001B[0m\u001B[38;2;235;201;196m%\u001B[0m\u001B[38;2;253;251;251m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;58;117;191m=\u001B[0m\u001B[38;2;23;92;178m-\u001B[0m\u001B[38;2;86;138;208m+\u001B[0m\u001B[38;2;189;206;192m#\u001B[0m\u001B[38;2;128;161;179m*\u001B[0m\u001B[38;2;110;153;215m+\u001B[0m\u001B[38;2;213;228;243m%\u001B[0m\u001B[38;2;252;238;234m@\u001B[0m\u001B[38;2;242;185;171m#\u001B[0m\u001B[38;2;219;128;109m*\u001B[0m\u001B[38;2;203;97;77m=\u001B[0m\u001B[38;2;193;79;59m=\u001B[0m\u001B[38;2;188;67;48m-\u001B[0m\u001B[38;2;181;51;31m-\u001B[0m\u001B[38;2;200;105;91m+\u001B[0m\u001B[38;2;245;231;229m@\u001B[0m\u001B[38;2;199;104;89m+\u001B[0m\u001B[38;2;177;39;17m-\u001B[0m\u001B[38;2;187;63;42m-\u001B[0m\u001B[38;2;194;77;57m=\u001B[0m\u001B[38;2;212;117;99m+\u001B[0m\u001B[38;2;240;183;169m#\u001B[0m\u001B[38;2;255;245;237m@\u001B[0m\u001B[38;2;249;255;255m@\u001B[0m\u001B[38;2;191;219;245m%\u001B[0m\u001B[38;2;78;129;196m=\u001B[0m\u001B[38;2;129;166;212m*\u001B[0m\u001B[38;2;195;208;176m#\u001B[0m\u001B[38;2;79;132;197m=\u001B[0m\u001B[38;2;11;85;178m:\u001B[0m\u001B[38;2;185;205;231m#\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;239;220;218m%\u001B[0m\u001B[38;2;188;69;50m=\u001B[0m\u001B[38;2;187;63;42m-\u001B[0m\u001B[38;2;188;66;47m-\u001B[0m\u001B[38;2;184;56;36m-\u001B[0m\u001B[38;2;198;96;79m=\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;252m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;252;248;247m@\u001B[0m\u001B[38;2;253;248;248m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;192;211;235m%\u001B[0m\u001B[38;2;51;112;188m=\u001B[0m\u001B[38;2;39;104;187m-\u001B[0m\u001B[38;2;99;145;192m+\u001B[0m\u001B[38;2;75;128;187m=\u001B[0m\u001B[38;2;24;94;183m-\u001B[0m\u001B[38;2;38;102;183m-\u001B[0m\u001B[38;2;84;139;204m+\u001B[0m\u001B[38;2;146;190;235m#\u001B[0m\u001B[38;2;198;226;251m%\u001B[0m\u001B[38;2;227;237;248m@\u001B[0m\u001B[38;2;243;235;236m@\u001B[0m\u001B[38;2;249;232;229m@\u001B[0m\u001B[38;2;252;229;223m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;250;220;212m%\u001B[0m\u001B[38;2;237;186;176m#\u001B[0m\u001B[38;2;243;207;199m%\u001B[0m\u001B[38;2;242;220;216m%\u001B[0m\u001B[38;2;239;234;238m@\u001B[0m\u001B[38;2;221;237;252m@\u001B[0m\u001B[38;2;183;215;245m%\u001B[0m\u001B[38;2;124;166;217m*\u001B[0m\u001B[38;2;64;120;192m=\u001B[0m\u001B[38;2;30;96;180m-\u001B[0m\u001B[38;2;28;96;181m-\u001B[0m\u001B[38;2;79;132;198m=\u001B[0m\u001B[38;2;94;142;185m+\u001B[0m\u001B[38;2;40;104;185m-\u001B[0m\u001B[38;2;110;154;209m+\u001B[0m\u001B[38;2;246;249;251m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;241;222;219m%\u001B[0m\u001B[38;2;189;72;54m=\u001B[0m\u001B[38;2;188;67;46m-\u001B[0m\u001B[38;2;189;70;51m=\u001B[0m\u001B[38;2;185;60;40m-\u001B[0m\u001B[38;2;199;99;83m=\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;253;253m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;254;253m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;253;252m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;254;252;252m@\u001B[0m\u001B[38;2;254;253;253m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;235;241;249m@\u001B[0m\u001B[38;2;142;175;218m*\u001B[0m\u001B[38;2;69;125;199m=\u001B[0m\u001B[38;2;46;109;190m-\u001B[0m\u001B[38;2;53;114;189m=\u001B[0m\u001B[38;2;50;112;189m=\u001B[0m\u001B[38;2;39;103;184m-\u001B[0m\u001B[38;2;30;96;179m-\u001B[0m\u001B[38;2;35;99;181m-\u001B[0m\u001B[38;2;54;114;190m=\u001B[0m\u001B[38;2;78;134;201m=\u001B[0m\u001B[38;2;102;152;212m+\u001B[0m\u001B[38;2;123;168;220m*\u001B[0m\u001B[38;2;127;166;214m*\u001B[0m\u001B[38;2;131;174;222m*\u001B[0m\u001B[38;2;131;180;231m*\u001B[0m\u001B[38;2;119;168;222m*\u001B[0m\u001B[38;2;94;149;211m+\u001B[0m\u001B[38;2;71;129;199m=\u001B[0m\u001B[38;2;46;108;186m-\u001B[0m\u001B[38;2;32;97;180m-\u001B[0m\u001B[38;2;32;98;182m-\u001B[0m\u001B[38;2;43;107;186m-\u001B[0m\u001B[38;2;52;113;190m=\u001B[0m\u001B[38;2;51;113;189m=\u001B[0m\u001B[38;2;64;121;193m=\u001B[0m\u001B[38;2;105;151;212m+\u001B[0m\u001B[38;2;188;208;233m%\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;252;248;247m@\u001B[0m\u001B[38;2;241;219;216m%\u001B[0m\u001B[38;2;241;218;215m%\u001B[0m\u001B[38;2;241;219;216m%\u001B[0m\u001B[38;2;241;217;214m%\u001B[0m\u001B[38;2;243;225;222m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;254;254m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\u001B[38;2;255;255;255m@\u001B[0m\n")

	if p.Config.File != "" {
		log("config loaded from '%s'", Yellow(p.Config.File))
	}

	if p.OsMaxOpenFiles == 0 {
		msg := Red(fmt.Sprintf("unable to detect OS open file limit"))
		log("%v", msg)
	} else if p.OsMaxOpenFiles <= int64(p.Config.Exec.Connections) {
		msg := fmt.Sprintf("detected low OS max open file limit %s, reduce connections from %s",
			Red(FGroup(int64(p.OsMaxOpenFiles))),
			Red(FGroup(int64(p.Config.Exec.Connections))))
		log(msg)
	} else {
		ul, _ := getUlimit()
		log("detected OS open file ulimit: %s", ul)
	}
	log("%s starting engines", Yellow(p.ID))
	log("duration: %s",
		Yellow(durafmt.Parse(time.Duration(p.Config.Exec.DurationSeconds)*time.Second).LimitFirstN(2).String()))
	log("preferred http version: %s", Yellow(fmt.Sprintf("%.1f", p.Config.Exec.HttpVersion)))
	log("parallel execution thread(s): %s", Yellow(FGroup(int64(p.Config.Exec.Threads))))
	log("max TCP conn(s): %s", Yellow(FGroup(int64(p.Config.Exec.Connections))))
	log("network dial timeout (inc. TLS handshake): %s",
		Yellow(durafmt.Parse(time.Duration(p.Config.Exec.DialTimeoutSeconds)*time.Second).LimitFirstN(2).String()))
	if p.Config.Exec.SpacingMillis > 0 {
		log("request spacing: %s",
			Yellow(durafmt.Parse(time.Duration(p.Config.Exec.SpacingMillis)*time.Millisecond).LimitFirstN(2).String()))
	}
	if len(p.Output) > 0 {
		log("log sampling rate: %s%s", Yellow(FGroup(int64(100*p.Config.Exec.LogSampling))), Yellow("%"))
	}
	fmt.Printf(timefmt("%s %s"), Yellow(p.Config.Req.Method), Yellow(p.Config.Req.Url))
}

func (p *P0d) logLive() {
	elpsd := time.Now().Sub(p.Start).Seconds()

	lw := p.liveWriters
	fmt.Fprintf(lw[0], timefmt("runtime: %s"), p.bar.render(elpsd, p))

	fmt.Fprintf(lw[1], timefmt("HTTP req: %s"), Cyan(FGroup(int64(p.Stats.ReqAtmpts))))
	fmt.Fprintf(lw[2], timefmt("roundtrip throughput: %s%s"), Cyan(FGroup(int64(p.Stats.ReqAtmptsSec))), Cyan("/s"))
	fmt.Fprintf(lw[3], timefmt("roundtrip latency: %s%s"), Cyan(FGroup(int64(p.Stats.MeanElpsdAtmptLatency.Milliseconds()))), Cyan("ms"))
	fmt.Fprintf(lw[4], timefmt("bytes read: %s"), Cyan(p.Config.byteCount(p.Stats.SumBytesRead)))
	fmt.Fprintf(lw[5], timefmt("read throughput: %s%s"), Cyan(p.Config.byteCount(int64(p.Stats.MeanBytesReadSec))), Cyan("/s"))
	fmt.Fprintf(lw[6], timefmt("bytes written: %s"), Cyan(p.Config.byteCount(p.Stats.SumBytesWritten)))
	fmt.Fprintf(lw[7], timefmt("write throughput: %s%s"), Cyan(p.Config.byteCount(int64(p.Stats.MeanBytesWrittenSec))), Cyan("/s"))

	mrc := Cyan(fmt.Sprintf("%s/%s (%s%%)",
		FGroup(int64(p.Stats.SumMatchingResponseCodes)),
		FGroup(int64(p.Stats.ReqAtmpts)),
		fmt.Sprintf("%.2f", math.Floor(float64(p.Stats.PctMatchingResponseCodes*100))/100)))
	fmt.Fprintf(lw[8], timefmt("matching HTTP response codes: %v"), mrc)

	tte := fmt.Sprintf("%s/%s (%s%%)",
		FGroup(int64(p.Stats.SumErrors)),
		FGroup(int64(p.Stats.ReqAtmpts)),
		fmt.Sprintf("%.2f", math.Ceil(float64(p.Stats.PctErrors*100))/100))
	if p.Stats.SumErrors > 0 {
		fmt.Fprintf(lw[9], timefmt("transport errors: %v"), Red(tte))
	} else {
		fmt.Fprintf(lw[9], timefmt("transport errors: %v"), Cyan(tte))
	}

	//need to flush manually here to keep stdout updated
	lw[0].(*uilive.Writer).Flush()
}

func (p *P0d) logSummary() {
	for k, v := range p.Stats.ErrorTypes {
		pctv := 100 * (float32(v) / float32(p.Stats.ReqAtmpts))
		err := Red(fmt.Sprintf("  - error: [%s]: %s/%s (%s%%)", k,
			FGroup(int64(v)),
			FGroup(int64(p.Stats.ReqAtmpts)),
			fmt.Sprintf("%.2f", math.Ceil(float64(pctv*100))/100)))
		logv(err)
	}
}

func (p *P0d) logRequestAttempt(ra ReqAtmpt, prefix string, indent string, comma []byte) {
	if len(p.Output) > 0 {
		rand.Seed(time.Now().UnixNano())
		//only sample a subset of requests
		if rand.Float32() < p.Config.Exec.LogSampling {
			j, je := json.MarshalIndent(ra, prefix, indent)
			p.checkWrite(je)
			_, we := p.outFile.Write(j)
			p.checkWrite(we)
			_, we = p.outFile.Write(comma)
			p.checkWrite(we)
		}
	}
}

func (p *P0d) initOutFile() {
	var oe error
	if len(p.Output) > 0 {
		p.outFile, oe = os.Create(p.Output)
		p.checkWrite(oe)
		_, we := p.outFile.Write([]byte("["))
		p.checkWrite(we)
	}
}

func (p *P0d) initLiveWriters(n int) {
	//start live logging

	l0 := uilive.New()
	//this prevents the writer from flushing inbetween lines. we flush manually after each iteration
	l0.RefreshInterval = time.Hour * 24 * 30
	l0.Start()

	live := make([]io.Writer, 0)
	live = append(live, l0)
	for i := 0; i <= n; i++ {
		live = append(live, live[0].(*uilive.Writer).Newline())
	}

	//do this before setting off goroutines
	p.liveWriters = live

	//now start live logging
	go func() {
		for {
			p.logLive()
			time.Sleep(time.Millisecond * 100)
		}
	}()

}

func (p *P0d) checkWrite(e error) {
	if e != nil {
		fmt.Println(e)
		msg := Red(fmt.Sprintf("unable to write to output file %s", p.Output))
		logv(msg)
		syscall.Kill(syscall.Getpid(), syscall.SIGINT)
	}
}

func createRunId() string {
	uid, _ := uuid.NewRandom()
	return fmt.Sprintf("p0d-%s-race-%s", Version, uid)
}
